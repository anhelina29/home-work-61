<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
<h1>Orders list</h1>

<div class="container">

    <% if (order) { %>
        <h2>Order details</h2>
        <p><strong>Order ID:</strong> <%= order._id %></p>
        <p><strong>User:</strong> <%= order.userId?.email || order.userId %></p>
        <p><strong>Total:</strong> $<%= order.totalPrice %></p>
        <p><strong>Status:</strong> <%= order.status %></p>
        <p><strong>Products:</strong>
            <%= order.products.map(p => p.name).join(', ') %>
        </p>


    <% } else if (orders && orders.length > 0) { %>

        <table class="orders-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Order ID</th>
                    <th>User</th>
                    <th>Products</th>
                    <th>Total</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
            <% orders.forEach((order, i) => { %>
                <tr>
                    <td><%= i + 1 %></td>
                    <td><%= order._id %></td>
                    <td><%= order.userId?.email || order.userId %></td>
                    <td>
                        <% if (order.products && order.products.length > 0) { %>
                            <ul>
                            <% order.products.forEach(prod => { %>
                                <li><%= prod.name || prod %></li>
                            <% }) %>
                            </ul>
                        <% } else { %>
                            No products
                        <% } %>
                    </td>
                    <td>$<%= order.totalPrice %></td>
                    <td><%= order.status %></td>
                </tr>
            <% }) %>
            </tbody>
        </table>

    <% } else { %>
        <p>No orders found</p>
    <% } %>

</div>
</body>
</html>
